<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>Sinfonier - Editor</title>
	<link rel="icon" href="/favicon.ico" type="image/png" />
 	<link rel="shortcut icon" href="/favicon.ico" type="image/png" />

<link rel="stylesheet" type="text/css" href="/javascripts/yui/reset-fonts-grids/reset-fonts-grids.css">
<link rel="stylesheet" type="text/css" href="/javascripts/yui/assets/skins/sam/skin.css">
<link rel="stylesheet" type="text/css" href="/javascripts/inputex/css/inputEx.css">
<link rel="stylesheet" type="text/css" href="/javascripts/WireIt/plugins/editor/lib/accordionview/assets/skins/sam/accordionview.css">
<link rel="stylesheet" type="text/css" href="/javascripts/WireIt/assets/WireIt.css">
<link rel="stylesheet" type="text/css" href="/javascripts/WireIt/plugins/inputex/assets/extension.css">
<link rel="stylesheet" type="text/css" href="/javascripts/WireIt/plugins/editor/assets/WireItEditor.css">
  <%- cssTag('editor.css') %>
  <%- cssTag('editor-sinfonier.css') %>

</head>

<body class="yui-skin-sam">
<input type="hidden" id="previous" value=""/>
<input type="hidden" id="templateid" value=""/>

<div id="app" style="display: none;">

	<div id="top">
    <div class="logo">
      <a href="/"><img src="images/logo-editor.png"></a>
      <div id="nav">
        <ul>
          <li><a href="/dashboard">DASHBOARD</a></li>
          <li><a href="/topologies">TOPOLOGIES</a></li>
          <li><a href="/modules">MODULES</a></li>
          <li><a href="/users">USERS</a></li>
          <li class="current"><a href="/editor">EDITOR</a></li>
          <li><a href="/users/<%= current_user.name %>"><img src="/images/profile.png"></a></li>
          <li><a href="/sessions/logout"><img src="images/sign-out.png"></a></li>
        </ul>
      </div>
    </div>
		<div id="toolbar"></div>
		<div class="topright">
					<!--%- partial('login.ejs') %-->
		</div>
	</div>


	<div id="left">
	</div>
	
	<div id="right">
		<ul id="accordionView">
			<li>
				<h2>Properties</h2>
				<div>
					<div id="propertiesForm"></div>
				</div>
			</li>
			<li>
				<h2>Minimap</h2>
				<div style='position: relative;'>
					<div id="layerMap"></div>
				</div>
			</li>
			<li>
				<h2>Infos</h2>
				<div>
				  <div style="padding: 10px;">
	        		<p id="description-paragraph" style="font-weight: bold;">Welcome to Sinfonier !</p>
					
				  </div>
				</div>
			</li>
		</ul>
	</div>

	<div id="center">
	</div>


	<div id="bottom">
	</div>
	

	<div id="helpPanel">
	    <div class="hd"></div>
	    <div class="bd" style="text-align: left; padding: 20px;">
			<p style="font-weight: bold;">Welcome to Sinfonier,</p>
			<p>All the documentation about sinfonier is available at <a href="http://sinfonier-project.net">Sinfonier Project Website</a>.</p>
			<ul>
				<li>Getting Started with the editor</li>
				<li>The API</li>
			</ul>
					
					
	    </div>
	</div>

</div>

<div id="appLoading">
	Loading the editor...
</div>

<!--[if IE]><script type="text/javascript" src="/javascripts/lib/excanvas.js"></script><![endif]-->

<script type="text/javascript" src="/javascripts/yui/utilities/utilities.js"></script>
<script type="text/javascript" src="/javascripts/yui/container/container-min.js"></script>
<script type="text/javascript" src="/javascripts/yui/button/button-min.js"></script>
<script type="text/javascript" src="/javascripts/yui/resize/resize-min.js"></script>
<script type="text/javascript" src="/javascripts/yui/json/json-min.js"></script>
<script type="text/javascript" src="/javascripts/yui/layout/layout-min.js"></script>
<script type="text/javascript" src="/javascripts/yui/selector/selector-min.js"></script>
<!-- InputEx with wirable options (WirableField) -->
<%- jsTag('inputex/js/inputex.js') %>
<%- jsTag('inputex/js/Field.js') %>
<%- jsTag('WireIt/plugins/inputex/js/WirableField.js') %>
<%- jsTag('inputex/js/Group.js') %>
<%- jsTag('inputex/js/mixins/choice.js') %>
<%- jsTag('inputex/js/Visus.js') %>
<%- jsTag('inputex/js/fields/StringField.js') %>
<%- jsTag('inputex/js/fields/CombineField.js') %>
<%- jsTag('inputex/js/fields/Textarea.js') %>
<%- jsTag('inputex/js/fields/SelectField.js') %>
<%- jsTag('inputex/js/fields/IntegerField.js') %>
<%- jsTag('inputex/js/fields/NumberField.js') %>
<%- jsTag('inputex/js/fields/EmailField.js') %>
<%- jsTag('inputex/js/fields/UrlField.js') %>
<%- jsTag('inputex/js/fields/ListField.js') %>
<%- jsTag('inputex/js/fields/CheckBox.js') %>
<%- jsTag('inputex/js/fields/InPlaceEdit.js') %>
<%- jsTag('inputex/js/fields/ColorField.js') %>
<%- jsTag('inputex/js/fields/TypeField.js') %>
<%- jsTag('inputex/js/widgets/json-tree-inspector.js') %>
<%- jsTag('WireIt/plugins/inputex/js/fields.js') %>


<!-- YUI-Accordion -->
<%- jsTag('WireIt/plugins/editor/lib/accordionview/accordionview-min.js') %>
<!-- WireIt -->
<%- jsTag('WireIt/js/WireIt.js') %>
<%- jsTag('WireIt/js/CanvasElement.js') %>
<%- jsTag('WireIt/js/Wire.js') %>
<%- jsTag('WireIt/js/BezierWire.js') %>
<%- jsTag('WireIt/js/Terminal.js') %>
<%- jsTag('WireIt/js/TerminalProxy.js') %>
<%- jsTag('WireIt/js/Scissors.js') %>
<%- jsTag('WireIt/js/DD.js') %>
<%- jsTag('WireIt/js/DDResize.js') %>
<%- jsTag('WireIt/js/Container.js') %>
<%- jsTag('WireIt/js/Layer.js') %>
<%- jsTag('WireIt/plugins/inputex/js/FormContainer.js') %>
<%- jsTag('WireIt/plugins/inputex/js/TextareaContainer.js') %>
<%- jsTag('WireIt/js/LayerMap.js') %>
<%- jsTag('WireIt/plugins/editor/js/ModuleProxy.js') %>
<%- jsTag('WireIt/plugins/editor/js/BaseEditor.js') %>
<%- jsTag('WireIt/plugins/editor/js/WiringEditor.js') %>
<%- jsTag('WireIt/plugins/editor/js/adapters/ajax.js') %>
<%- jsTag('WireIt/js/ImageContainer.js') %>
<%- jsTag('WireIt/plugins/composable/js/ComposableWiringEditor.js') %>
<%- jsTag('WireIt/plugins/composable/js/ComposedContainer.js') %>

<script src="/javascripts/jquery/jquery-1.11.0.min.js"  type='text/javascript'></script>

<!--Webhookit editor -->
<%- jsTag('webhookit/editor/webhookit.js') %>
<script>
  <% /*Only admins see debug panel*/ %>
<% if (!current_user.isAdmin()) {  %>
  webhookit.language.layoutOptions.units =  WireIt.BaseEditor.defaultOptions.layoutOptions.units;
<% } %>
<% if (!current_user.managesParallelism()) {  %>
  WireIt.Container.useParallel = false;
<% } %>
WireIt.Container.maxParallel = <%= Module.maxParallelism %>;

WireIt.ComposableWiringEditor.modules[0].category = "System";
WireIt.ComposableWiringEditor.modules[0].container.icon = "/images/icons/door_in.png";

WireIt.ComposableWiringEditor.modules[1].category = "System";
WireIt.ComposableWiringEditor.modules[1].container.icon = "/images/icons/door_out.png";

webhookit.language.modules =  <%- JSON.stringify(definitions) %>;

<% /*Deprecating modules in a non intrusive way*/ %>
for (var i=0;i<WireIt.ComposableWiringEditor.modules.length;i++ )
{
  WireIt.ComposableWiringEditor.modules[i].category = "Deprecated";
}
for (var i=0;i<webhookit.language.modules.length;i++ )
{
  var cat = webhookit.language.modules[i].category;
  if (cat != "Spouts" && cat != "Bolts" && cat != "Drains" && cat != "Operators" )
  {
    webhookit.language.modules[i].category = "Deprecated";
  }
  if (webhookit.language.modules[i].name == "comment" || webhookit.language.modules[i]["container"]["type"] == "variable")
  {
    webhookit.language.modules[i].category = "Utils";
  }
}

var previousValue="";
  $(function(){
    $("input[name=name]").focus(function(){
      previousValue = $(this).val();
    }).change(function(){
      var currentValue = $(this).val();
      if (currentValue != previousValue)
      {
        $(this).data("dirty","true");
      }
    });

  });


</script>

<%- jsTag('webhookit/editor/adapter.js') %>
<%- jsTag('webhookit/editor/topology_editor.js') %>

<script>var username = <%- JSON.stringify(current_user.name) %>;</script>

<%- partial('partials/uservoice', { }) %>

</body>
</html>