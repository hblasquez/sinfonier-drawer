<!DOCTYPE html>
<html><head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Sinfonier - modules</title>
  <meta name="author" content="Eric Abouaf" lang="en">
  <meta name="copyright" content="Copyright 2011 Eric Abouaf">

  <link href="Sinfonier-modules_files/css.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="stylesheets/reset-fonts.css">
  <link rel="stylesheet" type="text/css" href="stylesheets/skin.css">
  <link rel="stylesheet" type="text/css" href="stylesheets/main.css">
  <link rel="stylesheet" type="text/css" href="stylesheets/inputEx.css">

<link rel="shortcut icon" href="http://sinfonier-project.net/favicon.ico">
<link rel="icon" href="http://sinfonier-project.net/favicon.ico" sizes="32x32">

<script src="Sinfonier-modules_files/utilities.js"></script>

</head>
<body>
<div id="doc3" class="yui-t7">
   <div id="hd">
     <div class="logo">
       <img src="images/logo.png"><span>/sɪŋfonɪər/</span>
     </div>
		
    
     <div id="nav">
     <ul>
        <li><a href="http://sinfonier-project.net/dashboard">DASHBOARD</a></li>
				<li><a href="http://sinfonier-project.net/topologies">TOPOLOGIES</a></li>
        <li><a href="http://sinfonier-project.net/modules">MODULES</a></li>
				<li><a href="http://sinfonier-project.net/editor">EDITOR</a></li>
				<li><a href="http://sinfonier-project.net/sessions/logout"><img src="images/sign-out.png"></a></li>
			</ul>
			</div>
			
     
   </div>
   <div id="bd">
	   <div class="yui-g">
	     <div class="pagewidth">
	      <!-- YOUR DATA GOES HERE -->
	      <script src="Sinfonier-modules_files/jquery.js" type="text/javascript"></script>
<h1>Edit module </h1>



<div id="messages">
<ul class="error">

  <li><span class="errlabel" data-index="">Name: </span><span>required</span></li>

</ul>
</div>


<form action="/modules/test" method="POST">
  <div class="formblock">
  <input name="_method" value="put" type="hidden">
  <input value="" name="_id" type="hidden">
  <div class="required"><label for="name">Name</label><input value="test" readonly="readonly" name="name" type="text"></div>
  <div class="required"><label for="type">Type</label>
    <select name="type" editable="false">
      
      <option selected="selected">bolt</option>
      
    </select>
  </div>
  <div class="required"><label for="codeURL">Code URL</label><input value="www.apple.com" name="codeURL" type="text"></div>
  <div><label for="description">Description</label><textarea rows="4" cols="50" maxlength="500" name="description">nothing</textarea></div>
  <label for="status">Status</label>
  <select name="status">
    <option selected="selected">Inactive</option>
    <option>Develop</option>
    <option>Active</option>
  </select>
  </div>
  <div class="fields"><label>Fields</label><a href="#" class="addField">Add</a>
		<div class="add-fields">
			<label for="field[name]">Name</label><input name="field[name]" type="text" class="error">
			<label for="field[label]">Label</label><input value="label" name="field[label]" type="text">
			<label for="field[type]">Type</label>
			<select name="field[type]">
			  <option selected="selected">string</option>
			  <option>number</option>
			  <option>boolean</option>
			</select>
			<label for="field[wirable]">Allows Variables</label>
			<select name="field[wirable]">
			  <option selected="selected" value="false">No</option>
			  <option value="true">Yes</option>
			</select>
			<a href="#" class="removeField">remove</a>
		</div>
  </div>
  <input class="button" value="Update" type="submit">
</form>
<div style="display:none">
  <form>
    <div id="fieldRow">
      <div class="add-fields">
			<label for="field[name]">Name</label><input name="field[name]" type="text" class="error">
			<label for="field[label]">Label</label><input value="label" name="field[label]" type="text">
			<label for="field[type]">Type</label>
			<select name="field[type]">
			  <option selected="selected">string</option>
			  <option>number</option>
			  <option>boolean</option>
			</select>
			<label for="field[wirable]">Allows Variables</label>
			<select name="field[wirable]">
			  <option selected="selected" value="false">No</option>
			  <option value="true">Yes</option>
			</select>
			<a href="#" class="removeField">remove</a>
		</div>
    </div>
  </form>
</div>
<script type="text/javascript">

  var module = {"name":"test","category":"Bolts","status":"Inactive","container":{"type":"bolt","icon":"/images/icons/book.png","xtype":"WireIt.FormContainer","title":"test","attributes":{"abstractionid":"test","class":"com.sinfonier.bolts.Test"},"codeURL":"www.apple.com","description":"nothing","fields":[{"type":"string","name":"","wirable":false,"label":"label"}],"terminals":[{"name":"in[]","direction":[0,-1],"offsetPosition":[82,-15],"ddConfig":{"type":"input","allowedTypes":["output"]},"nMaxWires":5},{"name":"out","direction":[0,1],"offsetPosition":{"left":52,"bottom":-15},"ddConfig":{"type":"output","allowedTypes":["input"]}}]},"user_id":"5301fcecf2daf36302000001","created_at":"2014-02-27T11:17:11.634Z","updated_at":"2014-02-27T11:17:29.988Z","author":{"name":"sinfonier","email":"sinfonier@sinfonier-project.net"},"_id":"530f1eb7204b87c609000004"};
  var container = module.container;
  if (container)
  {
    $("input[name='_id']").val(container["_id"]);
    $("input[name='name']").val(module["name"]);
    $("select[name='type']").val(container["type"]);
    $("input[name='codeURL']").val(container["codeURL"]);
    $("textarea[name='description']").val(container["description"]);
    $("select[name='status']").val(module["status"]);
    for(var i=0;i<container.fields.length;i++)
    {
      var field = $("#fieldRow div").clone();
      field.find("input[name='field[name]']").val(container.fields[i].name);
      field.find("input[name='field[label]']").val(container.fields[i].label);
      field.find("select[name='field[type]']").val(container.fields[i].type);
      field.find("select[name='field[wirable]']").val(container.fields[i].wirable ? "true":"false");
      field.appendTo($(".fields"));
    }
    if (module._id)
    {
      $("input[name='name']").attr('readonly', true);
      var valType = $("select[name='type']").val();
      $("select[name='type'] option").each(function() {
        if ( $(this).val() != valType ) {
          $(this).remove();
        }
      });
      //$("select[name='type']").attr('disabled', true);
      $("input[type='submit']").val("Update");
    }
  }

  var redesign = function(name)
  {
    var parsed = name.split(".");
    var result = "";
    for (var i=(parsed.length - 1);i>=0;i--)
    {
      if (result != "")
      {
        result = parsed[i]+"["+result+"]";
      }
      else
      {
        result = parsed[i];
      }
    }
    return result;
  }

  $( function(){
    $(".fields").on("click",".addField",function(){
      $("#fieldRow div").clone().appendTo($(".fields"));
      return false;
    });

    $(".fields").on("click",".removeField",function(){
      $(this).closest("div").remove();
    });


    $(".errlabel").each(function(){
      var name = $(this).html();

     var change = $("label[for='"+redesign(name)+"']");
     var index = $(this).data("index");
     var indexInfo = "";
     if (index != '')
     {
       $(change.get(parseInt(index))).addClass("error");
       indexInfo="["+index+"]";
     }
     else
     {
       change.addClass("error");
     }

      if (change.length > 0)
        $(this).html(change.html()+indexInfo+": ");
    });
  });
</script>






	     </div>
	   </div>
	</div>

  <div id="ft">
    <div class="pagewidth">
      <a href="http://sinfonier-project.net/about/" target="_blank">About Sinfonier</a>
     </div>
  </div>
</div>	

</body></html>
